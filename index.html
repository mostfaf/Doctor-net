<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <!-- ... الأجزاء السابقة من head بدون تغيير ... -->
    
    <!-- إضافة مكتبة Flatpickr للتقويم -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
        /* إضافة أنماط جديدة */
        .sponsored-by {
            text-align: center;
            padding: 15px;
            background: var(--primary);
            color: white;
            margin-top: 30px;
        }
        
        .file-upload {
            position: relative;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .file-upload input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
        }
        
        .upload-label {
            display: block;
            padding: 10px;
            background: var(--light);
            border: 2px dashed var(--secondary);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <!-- ... الأجزاء السابقة من body بدون تغيير ... -->

    <!-- تعديل قسم حجز الطلبات -->
    <section id="booking" class="booking-section">
        <div class="container">
            <div class="section-title">
                <h2>حجز طلب دعم فني</h2>
            </div>
            <form id="bookingForm" class="booking-form">
                <!-- ... الحقول الحالية ... -->
                
                <div class="form-group">
                    <label>تاريخ ووقت الحجز</label>
                    <input type="text" id="datetime" class="form-control" placeholder="اختر التاريخ والوقت" required>
                </div>

                <div class="form-group">
                    <label>إرفاق صور للمشكلة (اختياري)</label>
                    <div class="file-upload">
                        <input type="file" id="attachments" accept="image/*" multiple>
                        <label for="attachments" class="upload-label">
                            <i class="fas fa-camera"></i> انقر لرفع الصور
                            <span id="file-count">0 ملف مرفق</span>
                        </label>
                    </div>
                </div>

                <button type="submit" class="btn btn-block">إرسال الطلب</button>
            </form>
        </div>
    </section>

    <!-- إضافة الإشعارات -->
    <div id="notification" class="notification"></div>

    <!-- تعديل الفوتر -->
    <footer>
        <div class="container footer-content">
            <!-- ... العناصر الحالية ... -->
            
            <div class="social-links">
                <a href="https://www.facebook.com/share/1LbqVhLK7T/" target="_blank">
                    <i class="fab fa-facebook"></i>
                </a>
                <a href="https://wa.me/201064496440" target="_blank">
                    <i class="fab fa-whatsapp"></i>
                </a>
            </div>

            <div class="sponsored-by">
                <p>برعاية سيستم سمارت راديوس</p>
            </div>

            <p class="copyright">
                جميع الحقوق محفوظة &copy; <span id="year"></span> 
                <br>
                دكتور نت - مصطفى عاطف الشوري
            </p>
        </div>
    </footer>

    <!-- إضافة السكريبتات -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ar.js"></script>
    <script>
        // تهيئة التقويم
        flatpickr("#datetime", {
            enableTime: true,
            dateFormat: "Y-m-d H:i",
            locale: "ar",
            time_24hr: true,
            minDate: "today"
        });

        // إدارة رفع الملفات
        document.getElementById('attachments').addEventListener('change', function(e) {
            document.getElementById('file-count').textContent = 
                `${e.target.files.length} ملف مرفق`;
        });

        // إدارة الإشعارات
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            notification.style.backgroundColor = 
                type === 'success' ? 'var(--success)' : 'var(--danger)';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }

        // تعديل إدارة حالة التذاكر
        function updateTicketStatus(ticketId, newStatus) {
            const tickets = JSON.parse(localStorage.getItem('doctornet_tickets')) || [];
            const ticket = tickets.find(t => t.id === ticketId);
            
            if(ticket) {
                ticket.status = newStatus;
                localStorage.setItem('doctornet_tickets', JSON.stringify(tickets));
                showNotification(`تم تحديث حالة الطلب #${ticketId} إلى ${newStatus}`);
            }
        }

        // تعديل إرسال النموذج
        document.getElementById('bookingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // ... معالجة البيانات ...
            
            // إرسال إلى الفيسبوك
            const fbMessage = `طلب دعم فني جديد من ${name}\nرقم الهاتف: ${phone}\nرقم الطلب: ${ticketNumber}`;
            const encodedFbMessage = encodeURIComponent(fbMessage);
            window.open(`https://www.facebook.com/share/1LbqVhLK7T/?text=${encodedFbMessage}`, '_blank');
        });

        // إضافة التحكم في التذاكر
        document.querySelectorAll('.ticket-actions button').forEach(button => {
            button.addEventListener('click', function() {
                const ticketId = this.closest('.ticket-item').querySelector('span').textContent.replace('#','');
                const action = this.classList.contains('btn-success') ? 'completed' : 
                             this.classList.contains('btn-danger') ? 'cancelled' : null;
                
                if(action) {
                    updateTicketStatus(ticketId, action);
                }
            });
        });
    </script>
</body>
</html>
